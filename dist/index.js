!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.domponent=e():t.domponent=e()}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function o(t){return t.trim().split(":")}function r(t){return t.trim().split("|")}function s(t){return t.trim().split(",")}n.r(e),n.d(e,"Component",function(){return i});class i{constructor(t){this.root=t.rootEl,this.key=t.key,this.__app=t.app,this._createComponent(),this._initState()}_bindListeners(){this.root.querySelectorAll("[data-action]").forEach(t=>{r(t.getAttribute("data-action")).forEach(e=>{const n=o(e),r=n[0],s=n[1];t.addEventListener(r,t=>this[s](t))},this)},this)}_createComponent(){this.dependents=new Set,this.props={},this.state={},this.propObjects=this._createPropObjects(),this.stateObjects=this._createStateObjects(),this._bindListeners(),this.componentMade()}_createPropObjects(){const t=this.root.getAttribute("data-props");if(t){const e={};return r(t).forEach(t=>{const n=function(t){return t.trim().split("<-")}(t),r=o(n[1]),s=n[0],i=this.__app.registeredComponents[r[0]],p=r[1];i.dependents.add(this.key);const a=[...this.root.querySelectorAll(`[data-bind^="props:${s}"]`)];this.props[s]=i.state[p],e[s]={parentComponent:i,parentComponentKey:p,els:a.length>0?a:null}},this),e}return null}_createStateObjects(){const t=this.root.querySelectorAll('[data-bind^="state:"]');if(t.length>0){const e={};return t.forEach(t=>{const n={};r(t.getAttribute("data-bind")).forEach(r=>{const i=o(r),p=i[1];let a=i[2];a&&(a=s(a)),n.el=t,n.attrs=a,e[p]||(e[p]=[]),e[p].push(n)})},this),e}return null}_initState(){const t=this.root.getAttribute("data-state");if(t){const e=r(t),n={};e.forEach(t=>{const e=o(t);n[e[0]]=e[1]}),this.setState(n)}}_updateDependents(t){this.dependents.forEach(e=>{this.__app.registeredComponents[e]._updateProps(t)})}_updateDOM(t,e,n){n?s(n).forEach(n=>{this.updateAttr(t,n,e)}):t.textContent=e}_updateProps(t){this.propsWillUpdate();const e=Object.assign({},this.props);for(let e in this.propObjects){const n=this.propObjects[e];t.includes(this.propObjects[e].parentComponentKey)&&(this.props[e]=n.parentComponent.state[n.parentComponentKey],this.propObjects[e].els&&this.propObjects[e].els.forEach(t=>{this._updateDOM(t,this.props[e])}))}this.propsDidUpdate(e)}componentMade(){}propsWillUpdate(){}propsDidUpdate(){}stateWillUpdate(){}stateDidUpdate(){}setState(t=this.state,e){this.stateWillUpdate();const n=[];for(let e in t)if(t[e]!==this.state[e]){n.push(e),this.state[e]=t[e];const o=[...this.root.querySelectorAll(`[data-bind="state:${e}"]`)];o.length>0&&o.forEach(n=>{this._updateDOM(n,t[e])})}this.dependents.size>0&&this._updateDependents(n),e&&e(),this.stateDidUpdate()}}e.default=function(t){return this.components=t.components,this.registeredComponents={},this._cc=(e,n)=>{const o=e.getAttribute("data-key")||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)});this.registeredComponents[o]=new(t.components[e.getAttribute("data-component")])({rootEl:e,key:o,app:this}),n&&n()},this._dc=(t,e)=>{delete this.registeredComponents[t],e&&e()},this._rc=(t,e,n)=>{this.components[t]=e,n&&n()},this._urc=(t,e)=>{delete this.component[t],e&&e()},[...t.selector.querySelectorAll("[data-component]")].forEach(t=>{this._cc(t)},this),t.appCreated&&t.appCreated(),{createComponent:(t,e)=>this._cc(t,e),deleteComponent:(t,e)=>this._dc(t,e),register:(t,e,n)=>this._rc(t,e,n),unregister:(t,e)=>this._urc(t,e)}}}])});